{% extends 'donor/donorbase.html' %}
{% load static %}

{% block content %}
<div class="container my-4">

  <h2 class="mb-3">Nearby Compatible Patients</h2>
  
  <p>
    Based on your blood group: <strong>{{ user_blood_type }}</strong>, 
    here are patients near you who can receive your blood.
  </p>

  {% if nearby_patients %}
    <div class="list-group">
      {% for patient, distance in nearby_patients %}
        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
          <div>
            <h5 class="mb-1">{{ patient.user.get_full_name }}</h5>
            <p class="mb-1"><strong>Blood Group:</strong> {{ patient.bloodgroup }}</p>
            <p class="mb-0"><strong>Address:</strong> {{ patient.address|default:"N/A" }}</p>
          </div>
          <small class="text-muted">{{ distance }} km away</small>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info" role="alert">
      No compatible patients found nearby at this time.
    </div>
  {% endif %}

  <a href="{% url 'donor-dashboard' %}" class="btn btn-secondary mt-4">Back to Dashboard</a>
</div>
{% endblock %}
